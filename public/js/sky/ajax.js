"use strict";function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var r=[],a=!0,o=!1,i=void 0;try{for(var l,n=t[Symbol.iterator]();!(a=(l=n.next()).done)&&(r.push(l.value),!e||r.length!==e);a=!0);}catch(t){o=!0,i=t}finally{try{a||null==n.return||n.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var ajax=function(){var queues={};function bindAjaxify(t){if(t){var e=!0,r=!1,a=void 0;try{for(var o,i=function(){var e=o.value,r=e.tagName.toLowerCase(),a=void 0,i=e,l=e.getAttribute("data-method")||"post",n=e.getAttribute("data-ajax-alert")||"form",s=e.getAttribute("data-queue")||"sync",d=e.getAttribute("data-spinner")||"icon";"form"===r?(a=e.getAttribute("action"),l=e.getAttribute("method").toLowerCase()):a="button"===r?e.getAttribute("data-action"):e.href,e.addEventListener("form"===r?"submit":"click",function(o){if(o.preventDefault(),"object"===("undefined"==typeof CKEDITOR?"undefined":_typeof(CKEDITOR)))for(var u=0,c=Object.keys(CKEDITOR.instances);u<c.length;u++){var m=c[u];CKEDITOR.instances[m].updateElement()}e.getAttribute("data-form")&&(i=t.querySelector("#"+e.getAttribute("data-form")),r="form");var f=-1===a.indexOf("?")?"?":"&",p="";f=-1===(p+=null!==e.getAttribute("data-overview")?f+"overview=true":"").indexOf("?")?"?":"&",p+=null!==e.getAttribute("data-query")?f+e.getAttribute("data-query"):"",ajaxify({obj:e,method:l,alert:n,queue:s,spinner:d,action:a+(null!==e.getAttribute("data-append-id")?"/"+datatable.selected[e.getAttribute("data-table")]:"")+p,data:"form"===r?new FormData(i):null}).then(function(t){}).catch(function(t){})})},l=t.querySelectorAll("[data-ajax]")[Symbol.iterator]();!(e=(o=l.next()).done);e=!0)i()}catch(t){r=!0,a=t}finally{try{e||null==l.return||l.return()}finally{if(r)throw a}}}}function ajaxify(params){return new Promise(function(resolve,reject){queues[params.queue]={},params.queue.startsWith("sync")&&ajaxAbort(params.queue),params.obj&&(params.tag=params.obj.tagName.toLowerCase(),params.skipLock||ajaxLock(params));var jqxhr=$.ajaxq(params.queue,{url:params.action,data:params.data,type:params.method});jqxhr.done(function(data,textStatus,jqXHR){if(jqXHR.getResponseHeader("X-Location")&&window.location.replace(jqXHR.getResponseHeader("X-Location")),data.reload&&window.location.reload(!0),data.callback){var callback=eval(data.callback);"function"==typeof callback&&callback(data)}if(params.obj&&(params.skipLock||ajaxUnlock(params),ajaxClear(params.obj,params.tag)),data.status){params.obj.setAttribute("href",data.status.href),params.obj.setAttribute("title",data.status.title);var icon=params.obj.querySelector("[data-fa-i2svg]");icon&&params.obj.removeChild(icon),params.obj.insertAdjacentHTML("afterbegin",'<i class="far fa-'+data.status.icon+' fa-fw fa-lg"></i>')}if(data.errors&&!params.skipErrors&&ajaxError(params,data.errors),(data.reset||data._old_input)&&ajaxReset(params.obj,data),data.resetEditor)for(var _i2=0,_Object$keys2=Object.keys(CKEDITOR.instances);_i2<_Object$keys2.length;_i2++){var editor=_Object$keys2[_i2];CKEDITOR.instances[editor].setData("")}if(data.datatables&&(datatable.draw(data.datatables),$('[data-toggle="popover"]').popover()),data.closeModal&&$(".modal").modal("hide"),data.enable){var _iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var _iterator2=document.querySelectorAll(data.enable.join(", "))[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=!0){var node=_step2.value;node.classList.remove("disabled")}}catch(t){_didIteratorError2=!0,_iteratorError2=t}finally{try{_iteratorNormalCompletion2||null==_iterator2.return||_iterator2.return()}finally{if(_didIteratorError2)throw _iteratorError2}}}if(data.disable){var _iteratorNormalCompletion3=!0,_didIteratorError3=!1,_iteratorError3=void 0;try{for(var _iterator3=document.querySelectorAll(data.disable.join(", "))[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=!0){var _node=_step3.value;_node.classList.add("disabled")}}catch(t){_didIteratorError3=!0,_iteratorError3=t}finally{try{_iteratorNormalCompletion3||null==_iterator3.return||_iterator3.return()}finally{if(_didIteratorError3)throw _iteratorError3}}}if(data.show){var _iteratorNormalCompletion4=!0,_didIteratorError4=!1,_iteratorError4=void 0;try{for(var _iterator4=document.querySelectorAll(data.show.join(", "))[Symbol.iterator](),_step4;!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=!0){var _node2=_step4.value;_node2.classList.remove("hidden"),_node2.removeAttribute("hidden")}}catch(t){_didIteratorError4=!0,_iteratorError4=t}finally{try{_iteratorNormalCompletion4||null==_iterator4.return||_iterator4.return()}finally{if(_didIteratorError4)throw _iteratorError4}}}if(data.hide){var _iteratorNormalCompletion5=!0,_didIteratorError5=!1,_iteratorError5=void 0;try{for(var _iterator5=document.querySelectorAll(data.hide.join(", "))[Symbol.iterator](),_step5;!(_iteratorNormalCompletion5=(_step5=_iterator5.next()).done);_iteratorNormalCompletion5=!0){var _node3=_step5.value;_node3.classList.add("hidden"),_node3.setAttribute("hidden","")}}catch(t){_didIteratorError5=!0,_iteratorError5=t}finally{try{_iteratorNormalCompletion5||null==_iterator5.return||_iterator5.return()}finally{if(_didIteratorError5)throw _iteratorError5}}}if(data.success){var obj=params.obj;params.alert&&(obj=obj.closest(params.alert)),ajaxSuccess(params,data.success,data.closeModal?"main":params.tag)}params.modal&&setupModal(params.obj,params.modal,data.modal),resolve(data)}),jqxhr.fail(function(t,e,r){"abort"===e||params.skipErrors?params.obj&&(ajaxUnlock(params),ajaxClear(params.obj,params.tag)):String(t.status).startsWith(30)?window.location.replace(t.getResponseHeader("X-Location")):(params.obj&&(ajaxUnlock(params),ajaxClear(params.obj,params.tag)),422===t.status?ajaxError(params,t.responseJSON.errors):params.modal?setupModal(params.obj,params.modal,{title:e.charAt(0).toUpperCase()+e.slice(1),content:r}):ajaxError(params,e.charAt(0).toUpperCase()+e.slice(1)+": "+r)),reject(r)})})}function setupModal(obj,modal,data){if("object"===_typeof(data)){if(modal.querySelector("#modalTitle").innerHTML=data.title,modal.querySelector(".modal-body").innerHTML=data.content,data.resources){var regex=/\d{10}\./,resources=data.resources.split(",").map(function(t){return t.trim()}).filter(function(t){return t}),urls=resources.map(function(t){return t.replace(regex,"")}),_iteratorNormalCompletion6=!0,_didIteratorError6=!1,_iteratorError6=void 0;try{for(var _iterator6=document.styleSheets[Symbol.iterator](),_step6;!(_iteratorNormalCompletion6=(_step6=_iterator6.next()).done);_iteratorNormalCompletion6=!0){var style=_step6.value;if(style.href){var href=style.href.replace(regex,"");urls.includes(href)&&delete resources[urls.indexOf(href)]}}}catch(t){_didIteratorError6=!0,_iteratorError6=t}finally{try{_iteratorNormalCompletion6||null==_iterator6.return||_iterator6.return()}finally{if(_didIteratorError6)throw _iteratorError6}}var _iteratorNormalCompletion7=!0,_didIteratorError7=!1,_iteratorError7=void 0;try{for(var _iterator7=document.scripts[Symbol.iterator](),_step7;!(_iteratorNormalCompletion7=(_step7=_iterator7.next()).done);_iteratorNormalCompletion7=!0){var script=_step7.value,src=script.src.replace(regex,"");urls.includes(src)&&delete resources[urls.indexOf(src)]}}catch(t){_didIteratorError7=!0,_iteratorError7=t}finally{try{_iteratorNormalCompletion7||null==_iterator7.return||_iterator7.return()}finally{if(_didIteratorError7)throw _iteratorError7}}resources=resources.filter(Boolean),resources.length?loadjs(resources,{success:function success(){data.callback&&eval(data.callback)},async:!1}):data.callback&&eval(data.callback)}else data.callback&&eval(data.callback);data.script&&eval(data.script);var ids=modal.querySelector('input[name="ids"]');if(ids){var selected=String(datatable.selected[modal.querySelector("form").getAttribute("data-table")]).split(","),_iteratorNormalCompletion8=!0,_didIteratorError8=!1,_iteratorError8=void 0;try{for(var _iterator8=selected.entries()[Symbol.iterator](),_step8;!(_iteratorNormalCompletion8=(_step8=_iterator8.next()).done);_iteratorNormalCompletion8=!0){var _step8$value=_slicedToArray(_step8.value,2),key=_step8$value[0],value=_step8$value[1],row=document.querySelector("#\\3"+value.charAt(0)+" "+value.substring(1));row&&row.classList.contains("protected")&&selected.splice(key,1)}}catch(t){_didIteratorError8=!0,_iteratorError8=t}finally{try{_iteratorNormalCompletion8||null==_iterator8.return||_iterator8.return()}finally{if(_didIteratorError8)throw _iteratorError8}}ids.value=selected}var submit=modal.querySelector('[type="submit"]');if(submit){bindAjaxify(modal);var submitComputedStyle=window.getComputedStyle(submit);submit.style.bottom=parseFloat(submitComputedStyle.bottom)-parseFloat(submit.getBoundingClientRect().height)/2-4+"px";var width=0,children=modal.querySelector(".modal-footer").children,_iteratorNormalCompletion9=!0,_didIteratorError9=!1,_iteratorError9=void 0;try{for(var _iterator9=children[Symbol.iterator](),_step9;!(_iteratorNormalCompletion9=(_step9=_iterator9.next()).done);_iteratorNormalCompletion9=!0){var node=_step9.value,nodeComputedStyle=window.getComputedStyle(node);width+=node.offsetWidth+parseFloat(nodeComputedStyle.marginLeft)+parseFloat(nodeComputedStyle.marginRight)}}catch(t){_didIteratorError9=!0,_iteratorError9=t}finally{try{_iteratorNormalCompletion9||null==_iterator9.return||_iterator9.return()}finally{if(_didIteratorError9)throw _iteratorError9}}submit.style.right=width+15+"px"}data.fulscreen&&modal.classList.add("modal-fulscreen")}else modal.querySelector("#modalTitle").innerHTML=data,modal.querySelector(".modal-body").innerHTML=data,modal.querySelector(".btn").autofocus=!0}function ajaxAbort(t){$.ajaxq.isRunning(t)&&$.ajaxq.abort(t)}function ajaxLock(t){var e=t.obj;if("a"===t.tag?e.classList.add("disabled"):"button"===t.tag||"select"===t.tag?e.disabled=!0:(e=e.querySelector("[type=submit]"))&&(e.disabled=!0,t.obj.setAttribute("tabindex","-1"),t.obj.focus(),t.obj.addEventListener("keydown",function(r){r.defaultPrevented||27===(r.which||r.keyCode)&&e.classList.contains("js-submitted")&&(r.stopPropagation(),ajaxUnlock(t),ajaxAbort(t.queue))}),clearTimeout(queues[t.queue].timer),queues[t.queue].timer=window.setTimeout(function(){return e.classList.add("js-submitted")},1e3)),t.spinner){if(queues[t.queue].html=e.innerHTML,"replace"===t.spinner)e.innerHTML="";else{var r=e.querySelector("[data-fa-i2svg]");r&&e.removeChild(r)}e.insertAdjacentHTML("afterbegin",'<i class="fas fa-spinner fa-pulse'+("absolute"===t.spinner?" spinner-absolute":"")+'"></i>')}}function ajaxUnlock(t){var e=t.obj;"a"===t.tag?e.classList.remove("disabled"):"button"===t.tag||"select"===t.tag?e.disabled=!1:(clearTimeout(queues[t.queue].timer),(e=e.querySelector("[type=submit]"))&&(e.disabled=!1,e.focus(),e.classList.remove("js-submitted"))),t.spinner&&(e.innerHTML=queues[t.queue].html)}function ajaxClearSuccess(t,e){ajaxClear(t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:".alert-success")}function ajaxClearDanger(t,e){ajaxClear(t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:".alert-danger")}function ajaxClear(t,e){var r,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".alert";if("form"===e){r=t;var o=!0,i=!1,l=void 0;try{for(var n,s=t.querySelectorAll(".form-control")[Symbol.iterator]();!(o=(n=s.next()).done);o=!0){var d=n.value;d.classList.remove("is-valid"),d.classList.remove("is-invalid")}}catch(t){i=!0,l=t}finally{try{o||null==s.return||s.return()}finally{if(i)throw l}}var u=!0,c=!1,m=void 0;try{for(var f,p=t.querySelectorAll(".invalid-feedback")[Symbol.iterator]();!(u=(f=p.next()).done);u=!0){var b=f.value;b.parentNode.removeChild(b)}}catch(t){c=!0,m=t}finally{try{u||null==p.return||p.return()}finally{if(c)throw m}}}else r=document.querySelector("main");var y=!0,v=!1,_=void 0;try{for(var j,h=r.querySelectorAll(a)[Symbol.iterator]();!(y=(j=h.next()).done);y=!0){var g=j.value;g.parentNode.removeChild(g)}}catch(t){v=!0,_=t}finally{try{y||null==h.return||h.return()}finally{if(v)throw _}}}function ajaxSuccess(t,e,r){var a,o=!1;t.alert?a=t.obj.closest(t.alert):"form"===r?a=t.obj:(a=document.querySelector("main"),o=!0),a.insertAdjacentHTML("afterbegin",'<div class="alert alert-success alert-dismissible fade show" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="'+unikatSettings.text.close+'"><span aria-hidden="true">&times;</span></button>'+("object"===_typeof(e)?e.join("<br>"):e)+"</div>"),scrollIntoView("#"+a.id+" .alert"),o&&($(".alert").on("closed.bs.alert",refreshWaypoints),refreshWaypoints())}function ajaxError(t,e){var r,a=!1;if(t.alert?r=t.obj.closest(t.alert):"form"===t.tag?r=t.obj:(r=document.querySelector("main"),a=!0),"object"===_typeof(e)){Object.keys(e).length&&r.insertAdjacentHTML("afterbegin",'<div class="alert alert-danger alert-dismissible fade show" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="'+unikatSettings.text.close+'"><span aria-hidden="true">&times;</span></button>'+unikatSettings.alertErrorMessage+"</div>");for(var o=0,i=Object.keys(e);o<i.length;o++){var l=i[o],n=void 0;if(l.includes("[]"))n='input[name="'+l+'"]';else if(l.includes(".")){var s=l.split(".");n="#input-"+s[0]+"-"+(parseInt(s[1])+1)}else n="#input-"+l;var d=t.obj.querySelector(n);if(d){var u=d.closest(".form-group, .form-check");if(u){var c=u.querySelector(".multiselect-wrapper");c?(c.querySelector("button").classList.add("is-invalid"),c.insertAdjacentHTML("beforeend",'<div class="invalid-feedback">'+e[l].join("<br>")+"</div>")):(d.classList.add("is-invalid"),u.insertAdjacentHTML("beforeend",'<div class="invalid-feedback">'+e[l].join("<br>")+"</div>"))}}else r.querySelector(".alert").insertAdjacentHTML("beforeend",'<p class="fa-left"><i class="fas fa-exclamation-triangle"></i>'+e[l].join("<br>")+"</p>")}}else r.insertAdjacentHTML("afterbegin",'<div class="alert alert-danger alert-dismissible fade show" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="'+unikatSettings.text.close+'"><span aria-hidden="true">&times;</span></button>'+e+"</div>");scrollIntoView("#"+r.id+" .alert"),a&&($(".alert").on("closed.bs.alert",refreshWaypoints),refreshWaypoints())}function scrollIntoView(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,a=window.scrollY||window.pageYOffset;switch(_typeof(t)){case"number":e=a+t,t=null;break;case"object":e=t.getBoundingClientRect().top+a;break;case"string":e=(t=document.querySelector(t)).getBoundingClientRect().top+a}var o=e-r;"scrollBehavior"in document.documentElement.style||"function"!=typeof Tweezer?window.scrollTo(0,o):new Tweezer({start:a,end:o}).on("tick",function(t){return window.scrollTo(0,t)}).begin(),t&&(t.setAttribute("tabindex","-1"),t.focus())}function ajaxResetInput(t){var e=t.type.toLowerCase();["checkbox","radio"].includes(e)?t.checked=!1:["select-one","select-multiple"].includes(e)?t.selectedIndex=0:(t.value="",t.classList.contains("floatl__input")&&t.closest(".floatl").classList.remove("floatl--active"))}function ajaxReset(t,e){var r,a=t.querySelectorAll('input:not([type="hidden"]):not([type="submit"]):not([readonly]):not([disabled]), select:not([disabled]), textarea:not([readonly]):not([disabled])');if(e._old_input){r=Object.keys(e._old_input);var o=!0,i=!1,l=void 0;try{for(var n,s=a[Symbol.iterator]();!(o=(n=s.next()).done);o=!0){var d=n.value;r.includes(d.name)||ajaxResetInput(d)}}catch(t){i=!0,l=t}finally{try{o||null==s.return||s.return()}finally{if(i)throw l}}}if(e.reset)if(e.reset.only){var u=!0,c=!1,m=void 0;try{for(var f,p=e.reset.only[Symbol.iterator]();!(u=(f=p.next()).done);u=!0){var b=f.value;ajaxResetInput(document.querySelector("#input-"+b))}}catch(t){c=!0,m=t}finally{try{u||null==p.return||p.return()}finally{if(c)throw m}}}else if(e.reset.except){r=Object.values(e.reset.except);var y=!0,v=!1,_=void 0;try{for(var j,h=a[Symbol.iterator]();!(y=(j=h.next()).done);y=!0){var g=j.value;r.includes(g.name)||ajaxResetInput(g)}}catch(t){v=!0,_=t}finally{try{y||null==h.return||h.return()}finally{if(v)throw _}}}else{var x=!0,S=!1,w=void 0;try{for(var q,C=a[Symbol.iterator]();!(x=(q=C.next()).done);x=!0){ajaxResetInput(q.value)}}catch(t){S=!0,w=t}finally{try{x||null==C.return||C.return()}finally{if(S)throw w}}}}return $.ajaxSetup({processData:!1,contentType:!1,headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}}),bindAjaxify(document),$(".modal").on("show.bs.modal",function(t){var e=t.relatedTarget,r=-1===e.getAttribute("data-action").indexOf("?")?"?":"&",a="";r=-1===(a+=null!==e.getAttribute("data-overview")?r+"overview=true":"").indexOf("?")?"?":"&",a+=null!==e.getAttribute("data-query")?r+e.getAttribute("data-query"):"",ajaxify({obj:e,method:e.getAttribute("data-method")||"post",queue:e.getAttribute("data-queue")||"sync",alert:e.getAttribute("data-ajax-alert")||"form",spinner:e.getAttribute("data-spinner")||"icon",action:e.getAttribute("data-action")+(null!==e.getAttribute("data-append-id")?"/"+datatable.selected[e.getAttribute("data-table")]:"")+a,data:null,modal:this}).then(function(t){}).catch(function(t){})}),$(".modal").on("hidden.bs.modal",function(){this.querySelector("#modalTitle").innerHTML="",this.querySelector(".modal-body").innerHTML=""}),{ajaxify:ajaxify,bind:bindAjaxify,success:ajaxSuccess,error:ajaxError,clearSuccess:ajaxClearSuccess}}();